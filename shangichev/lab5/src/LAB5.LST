Microsoft (R) Macro Assembler Version 5.10                  12/1/21 23:59:33
                                                             Page     1-1


       1 = 0005				messnumber EQU 5
       2				
       3				
       4 0000				DATA SEGMENT
       5 0000  0000				keep_cs dw 0
       6 0002  0000				keep_ip dw 0
       7 0004  48 65 6C 6C 6F 20		message DB 'Hello $'
       8       24			
       9 000B				DATA ENDS
      10				
      11 0000				AStack SEGMENT STACK
      12 0000  0200[				DW 512 DUP(?)
      13	   ????			
      14			 ]	
      15				
      16 0400				AStack ENDS
      17				
      18				
      19 0000				CODE SEGMENT
      20					ASSUME CS:CODE, DS:DATA, SS:ASt
					ack
      21				
      22 0000				SUBR_PRINT PROC FAR
      23					; store registers
      24 0000  52				push dx
      25 0001  51				push cx
      26 0002  53				push bx
      27 0003  50				push ax
      28 0004  50				push ax
      29				
      30 0005  B0 00				mov al, 0
      31				
      32 0007					print_message:
      33 0007  B4 09					mov ah, 9
      34 0009  BA 0004 R				mov dx, offset message
      35 000C  CD 21					int 21h
      36				
      37 000E					set_delay:
      38 000E  59					pop cx
      39 000F  FE C9					dec cl
      40 0011  74 25					jz complete
      41 0013  51					push cx
      42				
      43 0014  3C 00					cmp al, 0
      44 0016  74 05					je first
      45				
      46 0018  D0 E0					shl al, 1
      47 001A  EB 03 90					jmp start
      48				
      49 001D					first:
      50 001D  04 01					add al, 1
      51				
      52 001F					start:
      53 001F  8A D8					mov bl, al
Microsoft (R) Macro Assembler Version 5.10                  12/1/21 23:59:33
                                                             Page     1-2


      54 0021  B4 2C					mov  ah, 2ch
      55 0023  CD 21					int  21h 
      56 0025  8A FE					mov bh, dh	
						
      57				
      58 0027					delaying:   
      59 0027  90					nop
      60 0028  B4 2C					mov  ah, 2ch
      61 002A  CD 21					int  21h 
      62 002C  3A F7					cmp dh, bh
      63 002E  74 F7					je delaying
      64				
      65 0030  8A FE					mov  bh, dh      
      66 0032  FE CB					dec  bl   
      67 0034  75 F1					jnz  delaying  
      68 0036  EB CF					jmp print_message
      69				
      70				
      71 0038					complete:
      72						; restore registers
      73 0038  58					pop ax
      74 0039  5B					pop bx
      75 003A  59					pop cx
      76 003B  5A					pop dx
      77				
      78 003C  B0 20					mov al, 20h
      79 003E  E6 20					out 20h, al
      80 0040  CF				iret
      81				
      82 0041				SUBR_PRINT ENDP
      83				
      84				
      85 0041				Main PROC FAR
      86 0041  1E			    push DS
      87 0042  2B C0			    sub ax, ax
      88 0044  50			    push ax
      89 0045  B8 ---- R		    mov ax, DATA
      90 0048  8E D8			    mov ds, ax
      91				
      92 004A  B8 3523			    mov ax, 3523h
      93 004D  CD 21			    int 21h
      94 004F  8C 06 0000 R		    mov keep_cs, es
      95 0053  89 1E 0002 R		    mov keep_ip, bx
      96				
      97 0057  1E			    push ds
      98 0058  BA 0000 R		    mov dx, offset SUBR_PRINT
      99 005B  B8 ---- R		    mov ax, seg SUBR_PRINT
     100 005E  8E D8			    mov ds, ax
     101 0060  B8 2523			    mov ax, 2523h
     102 0063  CD 21			    int 21h
     103 0065  1F			    pop ds
     104				 
     105				
     106 0066					begin:
Microsoft (R) Macro Assembler Version 5.10                  12/1/21 23:59:33
                                                             Page     1-3


     107 0066  B4 00					mov ah,0
     108 0068  CD 16					int 16h
     109 006A  3C 71					cmp al, 'q'
     110 006C  74 0A					je quit
     111 006E  3C 03					cmp al,3
     112 0070  75 F4					jnz begin
     113				
     114 0072  B0 05					mov al, messnumber ; se
					t number of messages		
						
     115 0074  CD 23					int 23h	
     116 0076  EB EE					jmp begin
     117				
     118 0078					quit:
     119				
     120				
     121				
     122				
     123 0078  FA			    cli
     124 0079  1E			    push ds
     125 007A  8B 16 0002 R		    mov dx, keep_ip
     126 007E  A1 0000 R		    mov ax, keep_cs
     127 0081  8E D8			    mov ds, ax
     128 0083  B8 2523			    mov ax, 2523h
     129 0086  CD 21			    int 21h
     130 0088  1F			    pop ds
     131 0089  FB			    sti
     132				    
     133 008A  CB			    ret
     134 008B				Main ENDP
     135				
     136 008B				CODE ENDS
     137				     END Main
Microsoft (R) Macro Assembler Version 5.10                  12/1/21 23:59:33
                                                             Symbols-1


Segments and Groups:

                N a m e         	Length	 Align	Combine Class

ASTACK . . . . . . . . . . . . .  	0400	PARA	STACK	
CODE . . . . . . . . . . . . . .  	008B	PARA	NONE	
DATA . . . . . . . . . . . . . .  	000B	PARA	NONE	

Symbols:            

                N a m e         	Type	 Value	 Attr

BEGIN  . . . . . . . . . . . . .  	L NEAR	0066	CODE

COMPLETE . . . . . . . . . . . .  	L NEAR	0038	CODE

DELAYING . . . . . . . . . . . .  	L NEAR	0027	CODE

FIRST  . . . . . . . . . . . . .  	L NEAR	001D	CODE

KEEP_CS  . . . . . . . . . . . .  	L WORD	0000	DATA
KEEP_IP  . . . . . . . . . . . .  	L WORD	0002	DATA

MAIN . . . . . . . . . . . . . .  	F PROC	0041	CODE	Length = 004A
MESSAGE  . . . . . . . . . . . .  	L BYTE	0004	DATA
MESSNUMBER . . . . . . . . . . .  	NUMBER	0005	

PRINT_MESSAGE  . . . . . . . . .  	L NEAR	0007	CODE

QUIT . . . . . . . . . . . . . .  	L NEAR	0078	CODE

SET_DELAY  . . . . . . . . . . .  	L NEAR	000E	CODE
START  . . . . . . . . . . . . .  	L NEAR	001F	CODE
SUBR_PRINT . . . . . . . . . . .  	F PROC	0000	CODE	Length = 0041

@CPU . . . . . . . . . . . . . .  	TEXT  0101h		
@FILENAME  . . . . . . . . . . .  	TEXT  lab5		
@VERSION . . . . . . . . . . . .  	TEXT  510		


    133 Source  Lines
    133 Total   Lines
     22 Symbols

  47474 + 461833 Bytes symbol space free

      0 Warning Errors
      0 Severe  Errors
